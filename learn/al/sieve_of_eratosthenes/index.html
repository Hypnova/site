<!--MCPT-->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Sieve of Eratosthenes – Learn Data Structures – MCPT</title>
  
  <!--Icon-->
  <link rel="icon" type="image/png" href="/icon.png">
  <!--Theme Colour-->
  <meta name="theme-color" content="#f48fb1">
  <!--Bootstrap-->
  <link href="/bootstrap/css/bootstrap.cur.css" rel="stylesheet">
  <!--MDB-->
  <link href="/mdb/css/mdb.cur.css" rel="stylesheet">
  <!--Fontawesome-->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.0/css/font-awesome.min.css">
  <!--Prism-->
  <link rel="stylesheet" href="/prism/prism.css">
  <!--Custom Styles-->
  <link href="/stylesheet.css" rel="stylesheet">
  
  <!--JQuery-->
  <script src="/jquery/jquery.js"></script>
</head>

<body>
  <div class="page">
  <!--Navbar-->
  <header>
  <nav class="navbar navbar-dark primary-color">
    <button class="navbar-toggler hidden-sm-up" type="button" data-toggle="collapse" data-target="#navcollapse">
      <i class="fa fa-bars"></i>
    </button>

    <div class="container">
      <div class=" collapse navbar-toggleable-xs" id="navcollapse">
        <a class="navbar-brand waves-effect" href="/"><img src="/pics/silhouette.png" class="noseldrag" height="26px" width="26px" style="float:left;"> <strong>MCPT</strong></a>

        <ul class="nav navbar-nav">
          <li class="nav-item">
            <a class="nav-link waves-effect" href="/learn">Learn</a>
          </li>
          <li class="nav-item">
            <a class="nav-link waves-effect" href="/editorials">Editorials</a>
          </li>
          <li class="nav-item">
            <a class="nav-link waves-effect" href="/ranks">Ranks</a>
          </li>
          <li class="nav-item">
            <a class="nav-link waves-effect" href="/oj">Online Judge</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle waves-effect" type="button" id="dropdown1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Misc</a>
            <div class="dropdown-menu" aria-labelledby="dropdown1">
              <a class="dropdown-item" href="/calendar">Calendar</a>
              <a class="dropdown-item" href="/resources">Resources</a>
              <a class="dropdown-item" href="/about">About</a>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  </header>

  <main>
  <div class="container">
    <!--CONTENT-->
    <div class="row">
      <ol class="breadcrumb">
        <li><a href="/">Home</a></li>
        <li><a href="/learn">Learn</a></li>
        <li><a href="/learn/al">Algorithms</a></li>
        <li class="active">Sieve of Eratosthenes</li>
      </ol>
    </div>
    
    <div class="row">
      <h1>Sieve of Eratosthenes</h1>
      <hr>
    </div>
    
    <div class="row">
      <p>Sieve of Eratosthenes is an algorithm for quickly generating all the prime numbers below a maximum number. </p>
      
      <p>The algorithm is based on the fact that a multiple of a prime number (other than itself) cannot be a prime number. </p>
      
      <p>First, a boolean array is created in the size up to the maximum number initialized to <code>true</code> (except for <code>0</code> and <code>1</code>). The array holds whether or not the number has been discovered as a prime number. </p>
      
      <p>Loop through all the numbers in the range \(2 .. \sqrt M\), we will see why. If the current number is a prime, then loop through its multiples and set their prime status to <code>false</code>. However, as an optimization, some of the multiples would have already been set to false, so we need not to start from \(2 n\). All the primes below \(n\) would have already been found and their multiples processed. Thus, we can start the loop from \(n^2\). Similarly, we only need to loop through the numbers \(2 .. \sqrt M\) because after \(\sqrt M\), any prime numbers found would only disprove the primeness of numbers that are past the range. </p>
      
      <p>Depending on what we want to do, we can loop through the prime array again and generate a list of all the prime numbers. Or maybe we want to check whether or not a number is prime. </p>
      
    </div>
      
    <div class="row">
      <h1 class="h1-responsive">Implementation</h1>
      <hr>
      
      <pre class="language-java"><code>
      boolean[] isPrime = new boolean[M + 1];
      Arrays.fill(isPrime, true); // Need to import java.util.Arrays;
      isPrime[0] = false;
      isPrime[1] = false;
      
      for(int i = 2; i * i &lt;= M; i++) {
          if(isPrime[i]) {
              for(int j = i * i; j &lt;= M; j += i)
                isPrime[j] = false;
          }
      }
      
      // Optional: Generate a list of primes
      ArrayList&lt;Integer&gt; primes = new ArrayList&lt;Integer&gt;
      for(int i = 2; i &lt;= M; i++)
          if(isPrime[i]) primes.add(i);
      </code></pre>
      
      <h2 class="h2-responsive">Time Complexity</h2>
      
      <p>\(\mathcal{O}(M \log \log M)\), where \(M\) is the maximum to calculate to. </p>
      
      <h2 class="h2-responsive">Space Complexity</h2>
      
      <p>\(\mathcal{O}(M)\), where \(M\) is the maximum to calculate to. </p>
    </div>
    
    <div class="row">
      <h1 class="h1-responsive">Conclusion</h1>
      <hr>
      
      <p>Sieve is a very fast algorithm for generating prime numbers within a range. You can tell whether or not a number is prime in constant time (great for answering queries). However, the algorithm requires the use of a large array. </p>
    </div>
    
    <div class="row">
      <h1 class="h1-responsive">Practice</h1>
      <hr>
      
      <ul class="large-list">
        <li><a href="https://dmoj.ca/problem/mwc15c6p2">MWC '15 #6 P2: Breadwinners</a></li>
        <li><a href="https://dmoj.ca/problem/dmopc15c1p4">DMOPC '15 Contest 1 P4 - Itami and Candy</a></li>
        <li><a href="https://dmoj.ca/problem/phantom2">DMOJ: The Third Cellar</a></li>
        <li><a href="https://dmoj.ca/problem/dmopc15c1p4">FHC '15 Round 1: Homework</a> (requires modifying the algorithm)</li>
      </ul>
      
    </div>
    
  </div>
  </main>
    
  <!--Footer-->
  <footer class="page-footer primary-color center-on-small-only">
    <div class="footer-copyright">
      <div class="container-fluid">
        &copy 2016 mcpt.ca
      </div>
    </div>
  </footer>
  </div>
  
  <!--Scripts-->
  <script src="/ga.js"></script>
  <script src="/prism/prism.js"></script>
  <script type="text/javascript" src="/bootstrap/js/bootstrap.cur.js"></script>
  <script type="text/javascript" src="/mdb/js/mdb.cur.js"></script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML"></script>
  <script src="/script.js"></script>
  
</body>
</html>
